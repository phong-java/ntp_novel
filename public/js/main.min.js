$(document).ready(function(){$("button.phong").on("click",function(){alert("phongllll")});var t='<span class="ntp_alert_close bg-success"><button type="button" class="btn-close"></button></span>',a='<span class="ntp_alert_close bg-danger"><button type="button" class="btn-close"></button></span>';$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$(".ntp_slick").slick({dots:!0,infinite:!1,speed:300,slidesToShow:6,slidesToScroll:6,infinite:!0,responsive:[{breakpoint:1024,settings:{slidesToShow:4,slidesToScroll:4,infinite:!0,dots:!0}},{breakpoint:600,settings:{slidesToShow:3,slidesToScroll:3}},{breakpoint:480,settings:{slidesToShow:2,slidesToScroll:2}}]}),$(".ntp_recommend").slick({centerMode:!0,centerPadding:"200px",slidesToShow:1,autoplay:!0,autoplaySpeed:3e3,responsive:[{breakpoint:768,settings:{centerMode:!0,centerPadding:"50px",slidesToShow:1}},{breakpoint:480,settings:{centerMode:!0,centerPadding:"0px",slidesToShow:1}}]}),$("button.ntp_btn_cat_create").on("click",function(){var e=$(".ntp_cat_create")[0],n=new FormData(e),r=$(".ntp_cat_create");$.ajax({method:"POST",url:$(e).attr("action"),contentType:!1,processData:!1,data:n,dataType:"json",success:function(e){if(1==e.status)$(r).find(".alert-danger").fadeOut(200),$(r).find(".alert-success").fadeIn(200).html(e.message+t);else if(0==e.status){$(r).find(".alert-success").fadeOut(200);var n=e.errors,o="";for(var i in n)o+=n[i]+"</br>";$(r).find(".alert-danger").fadeIn(200).html(o+a)}$("body").trigger("ntp-alert-out")},error:function(){}})}),$("body").on("click",".ntp_cat_edit",function(){var t=$(this),a=$(t).attr("data-link");$.ajax({method:"POST",url:a,success:function(t){var a=$(".ntp_edit_cat_ppoup");$(a).find(".modal-body").html(t)},error:function(){}})}),$("body").on("click",".ntp_edit_cat_ppoup .ntp_btn_update_cat",function(){var e=$(this),n=$(e).parents(".ntp_edit_cat_ppoup"),r=$(n).find(".modal-body form"),o=$(r).attr("action"),i=$(n).find(".modal-body form")[0],s=new FormData(i);$.ajax({method:"POST",url:o,data:s,contentType:!1,processData:!1,success:function(e){if($("body").trigger("ntp_admin_load_cat_list"),1==e.status)$(r).find(".alert-danger").fadeOut(200),$(r).find(".alert-success").fadeIn(200).html(e.message+t);else if(0==e.status){$(r).find(".alert-success").fadeOut(200);var n=e.errors,o="";for(var i in n)o+=n[i]+"</br>";$(r).find(".alert-danger").fadeIn(200).html(o+a)}$("body").trigger("ntp-alert-out")},error:function(){}})}),$("#danh_sach_theloai-tab").on("click",function(){$("body").trigger("ntp_admin_load_cat_list")}),$("body").on("ntp_admin_load_cat_list",function(){var t=$("#danh_sach_theloai-tab");if($(t).length){var a=$(t).attr("data-link");$.ajax({method:"POST",url:a,success:function(t){var a=$("#danh_sach_theloai");$(a).html(t)},error:function(){}})}}).trigger("ntp_admin_load_cat_list"),$("#ntp_login_form .ntp_submit_login").on("click",function(){var e=$(this),n=$(e).parents("#ntp_login_register_modal"),r=$(n).find("#ntp_login_form"),o=$(r).attr("action"),i=$(n).find("#ntp_login_form")[0],s=new FormData(i);$.ajax({method:"POST",url:o,data:s,contentType:!1,processData:!1,dataType:"json",success:function(e){if(1==e.status)$(r).find(".alert-danger").fadeOut(200),$(r).find(".alert-success").fadeIn(200).html(e.message+t),setTimeout(function(){location.reload()},400);else if(0==e.status){$(r).find(".alert-success").fadeOut(200);var n=e.errors,o="";for(var i in n)o+=n[i]+"</br>";$(r).find(".alert-danger").fadeIn(200).html(o+a)}$("body").trigger("ntp-alert-out")},error:function(){}})}),$("#ntp_register_form .ntp_submit_register").on("click",function(){var e=$(this),n=$(e).parents("#ntp_login_register_modal"),r=$(n).find("#ntp_register_form"),o=$(r).attr("action"),i=$(n).find("#ntp_register_form")[0],s=new FormData(i);$.ajax({method:"POST",url:o,data:s,contentType:!1,processData:!1,dataType:"json",success:function(e){if(console.log(e),1==e.status)$(r).find(".alert-danger").fadeOut(200),$(r).find(".alert-success").fadeIn(200).html(e.message+t),setTimeout(function(){location.reload()},2e3);else if(0==e.status){$(r).find(".alert-success").fadeOut(200);var n=e.errors,o="";for(var i in n)o+=n[i]+"</br>";$(r).find(".alert-danger").fadeIn(200).html(o+a)}$("body").trigger("ntp-alert-out")},error:function(){}})}),$(".ntp_btn_update_infor_user").on("click",function(e){var n=$(this),r=$(n).parents("#ntp_form_update_infor_user"),o=$(n).parents("#ntp_form_update_infor_user")[0],i=new FormData(o),s=$(r).attr("action");$.ajax({method:"POST",url:s,data:i,contentType:!1,processData:!1,dataType:"json",success:function(e){if(console.log(e),1==e.status)$(r).find(".alert-danger").fadeOut(200),$(r).find(".alert-success").fadeIn(200).html(e.message+t);else if(0==e.status){$(r).find(".alert-success").fadeOut(200);var n=e.errors,o="";for(var i in n)o+=n[i]+"</br>";$(r).find(".alert-danger").fadeIn(200).html(o+a)}$("body").trigger("ntp-alert-out")},error:function(){}}),e.preventDefault()}),$("body").on("change","#ntp_input_update_anhdaidien",function(){var e=$(this)[0],n=e.files[0];if(n){var r=new FileReader;r.onload=function(t){$(".ntp_av_wrap .ntp_av ").attr("src",t.target.result)},r.readAsDataURL(n);var o=$(this),i=($(o).parents("#ntp_form_update_av_user"),$(o).parents("#ntp_form_update_av_user")[0]),s=new FormData(i),d=$(o).attr("data-link");$.ajax({method:"POST",url:d,data:s,contentType:!1,processData:!1,dataType:"json",success:function(e){if(1==e.av_update.avatar_change_status){$(".ntp_av_wrap").find(".alert-danger").fadeOut(200),$(".ntp_av_wrap").find(".alert-success").fadeIn(200).html(e.av_update.avatar_change+t);var n=$(".ntp_av");$(n).each(function(){$(this).attr("src",e.av_update.av_link)})}else 0==e.av_update.avatar_change_status&&($(".ntp_av_wrap").find(".alert-success").fadeOut(200),$(".ntp_av_wrap").find(".alert-danger").fadeIn(200).html(e.av_update.avatar_change+a));$("body").trigger("ntp-alert-out")},error:function(){}})}}),$("body").on("change","#ntp_input_anhbiatruyen",function(){var t=$(this)[0],a=t.files[0];if(a){var e=new FileReader;e.onload=function(t){$(".ntp_anh_bia_wrap .ntp_anh_bia ").attr("src",t.target.result)},e.readAsDataURL(a)}}),$(".ntp_btn_create_author").on("click",function(e){var n=$(this),r=$(n).parents("#ntp_form_create_author"),o=$(n).parents("#ntp_form_create_author")[0],i=new FormData(o),s=$(r).attr("action");console.log(o),$.ajax({method:"POST",url:s,data:i,contentType:!1,processData:!1,dataType:"json",success:function(e){if(console.log(e),1==e.status)$(r).find(".alert-danger").fadeOut(200),$(r).find(".alert-success").fadeIn(200).html(e.message+t);else if(0==e.status){$(r).find(".alert-success").fadeOut(200);var n=e.errors,o="";for(var i in n)o+=n[i]+"</br>";$(r).find(".alert-danger").fadeIn(200).html(o+a)}e.file&&$(r).find("#ntp_camket_da_upload").attr("src",e.file),$("body").trigger("ntp-alert-out")},error:function(){}}),e.preventDefault()}),$("body").on("click",".ntp_btn_author_detail",function(){var t=$(this),a=$(t).attr("data-link");$.ajax({method:"POST",url:a,success:function(t){var a=$("#ntp_author_detail");$(a).find(".modal-body").html(t)},error:function(){}})}),$("body").on("click",".ntp_author_detail_update",function(){var e=$(this),n=$(e).parents("#ntp_author_detail"),r=$(n).find(".modal-body form"),o=$(r).attr("data-link"),i=$(n).find(".modal-body form")[0],s=new FormData(i);$.ajax({method:"POST",url:o,data:s,contentType:!1,processData:!1,success:function(e){if($("body").trigger("ntp_admin_load_xetduyet_author_list"),$("body").trigger("ntp_admin_load_author_list"),1==e.status)$(r).find(".alert-danger").fadeOut(200),$(r).find(".alert-success").fadeIn(200).html(e.message+t),setTimeout(function(){$(n).find(".btn-close").trigger("click")},1e3);else if(0==e.status){$(r).find(".alert-success").fadeOut(200);var o=e.errors,i="";for(var s in o)i+=o[s]+"</br>";$(r).find(".alert-danger").fadeIn(200).html(i+a)}$("body").trigger("ntp-alert-out")},error:function(){}})}),$("body").on("click",".ntp_btn_update_chapter",function(){var e=$(this),n=$(e).parents("form#ntp_form_update_chapter"),r=$(n).attr("action"),o=$(e).parents("form#ntp_form_update_chapter")[0],i=new FormData(o);$.ajax({method:"POST",url:r,data:i,contentType:!1,processData:!1,success:function(e){if(1==e.status)$(n).find(".alert-danger").fadeOut(200),$(n).find(".alert-success").fadeIn(200).html(e.message+t);else if(0==e.status){$(n).find(".alert-success").fadeOut(200);var r=e.errors,o="";for(var i in r)o+=r[i]+"</br>";$(n).find(".alert-danger").fadeIn(200).html(o+a)}$("body").trigger("ntp-alert-out")},error:function(){}})}),$("body").on("ntp_admin_load_xetduyet_author_list",function(){var t=$("#xet_duyet_tacgia-tab");if($(t).length){var a=$(t).attr("data-link");$.ajax({method:"POST",url:a,success:function(t){var a=$("#xet_duyet_tacgia");$(a).html(t)},error:function(){}})}}).trigger("ntp_admin_load_xetduyet_author_list"),$("body").on("click",".ntp_chitiettruyen",function(){var t=$(this),a=$(t).attr("data-link");$.ajax({method:"POST",url:a,success:function(t){var a=$("#ntp_edit_novel_poup ");$(a).find(".modal-body").html(t)},error:function(){}})}),$("body").on("click",".ntp_admin_btn_update_novel",function(){var e=$(this),n=$(e).parents("#ntp_edit_novel_poup"),r=$(n).find("#ntp_form_novel_License"),o=$(r).attr("action"),i=$(n).find(".modal-body form")[0],s=new FormData(i);$.ajax({method:"POST",url:o,data:s,contentType:!1,processData:!1,success:function(e){if($("body").trigger("ntp_admin_load_xetduyet_novel_list"),1==e.status)$(r).find(".alert-danger").fadeOut(200),$(r).find(".alert-success").fadeIn(200).html(e.message+t),setTimeout(function(){$(n).find(".btn-close").trigger("click")},1e3);else if(0==e.status){$(r).find(".alert-success").fadeOut(200);var o=e.errors,i="";for(var s in o)i+=o[s]+"</br>";$(r).find(".alert-danger").fadeIn(200).html(i+a)}$("body").trigger("ntp-alert-out")},error:function(){}}),$("body").trigger("ntp_admin_load_novel_list")}),$("#xet_duyet_tacpham-tab").click(function(){$("body").trigger("ntp_admin_load_xetduyet_novel_list")}),$("body").on("ntp_admin_load_xetduyet_novel_list",function(){var t=$("#xet_duyet_tacpham-tab");if($(t).length){var a=$(t).attr("data-link");$.ajax({method:"POST",url:a,success:function(t){var a=$("#xet_duyet_tacpham");$(a).html(t)},error:function(){}})}}).trigger("ntp_admin_load_xetduyet_novel_list"),$(".ntp_btn_create_novel,.ntp_btn_update_infor_novel").click(function(e){var n=$(this),r=$(n).parents("#ntp_form_create_novel"),o=$(r).attr("action"),i=CKEDITOR.instances.motatruyen.getData(),s=$(n).parents("#ntp_form_create_novel")[0],d=new FormData(s);d.set("motatruyen",i),$.ajax({method:"POST",url:o,data:d,contentType:!1,processData:!1,success:function(e){if(1==e.status)$(r).find(".alert-danger").fadeOut(200),$(r).find(".alert-success").fadeIn(200).html(e.message+t),$("body").trigger("ntp_author_load_novel_list");else if(0==e.status){$(r).find(".alert-success").fadeOut(200);var n=e.errors,o="";for(var i in n)o+=n[i]+"</br>";$(r).find(".alert-danger").fadeIn(200).html(o+a)}$("body").trigger("ntp-alert-out")},error:function(){}}),e.preventDefault()}),$(".ntp_btn_create_chapter").click(function(e){var n=$(this),r=$(n).parents("#ntp_form_create_chapter"),o=$(r).attr("action"),i=CKEDITOR.instances.noidungchuong.getData(),s=$(n).parents("#ntp_form_create_chapter")[0],d=new FormData(s);d.set("noidungchuong",i),console.log(d),$.ajax({method:"POST",url:o,data:d,contentType:!1,processData:!1,success:function(e){if(1==e.status)$(r).find(".alert-danger").fadeOut(200),$(r).find(".alert-success").fadeIn(200).html(e.message+t),$("body").trigger("ntp_author_load_novel_list");else if(0==e.status){$(r).find(".alert-success").fadeOut(200);var n=e.errors,o="";for(var i in n)o+=n[i]+"</br>";$(r).find(".alert-danger").fadeIn(200).html(o+a)}$("body").trigger("ntp-alert-out")},error:function(){}}),e.preventDefault()}),$("#danhsach_truyen-tab").on("click",function(){$("body").trigger("ntp_author_load_novel_list")}),$("body").on("ntp_author_load_novel_list",function(){var t=$("#danhsach_truyen-tab");if($(t).length){var a=$(t).attr("data-link");$.ajax({method:"POST",url:a,success:function(t){var a=$("#ntp_novel_list_wrap");$(a).html(t)},error:function(){}})}}).trigger("ntp_author_load_novel_list"),$("body").on("click",".admin_kiemduyet_chuong",function(){var t=$(this),a=$(t).attr("data-link"),e=$("#ntp_chapter_detail_admin");$(e).find(".ntp_load").html("Loading..."),$.ajax({method:"GET",url:a,success:function(t){var a=t.chapters;for(var n in a)switch(n){case"id":$(e).find("."+n).val(a[n]);break;case"iPublishingStatus":1==a[n]?$(e).find("#xuly_chapter").prop("checked",!0):$(e).find("#xuly_chapter").prop("checked",!1);break;case"iPublishingStatus":1==a[n]?$(e).find("#xuly_chapter").prop("checked",!0):$(e).find("#xuly_chapter").prop("checked",!1);break;case"iStatus":1==a[n]?$(e).find("#trangthai_chapter").prop("checked",!0):$(e).find("#trangthai_chapter").prop("checked",!1);break;case"icharges":1==a[n]?e.find("."+n).html("Có tính phí"):e.find("."+n).html("Không tính phí");break;default:$(e).find("."+n).html(a[n])}},error:function(){}})}),$("body").on("click",".ntp_chapter_detail_admin_check",function(){var e=$(this),n=$(e).parents(".ntp_chapter_detail_admin"),r=$(n).find("#ntp_form_chapter_check"),o=$(r).attr("action"),i=$(r).find("#xuly_chapter").is(":checked")?1:0,s=$(r).find("#trangthai_chapter").is(":checked")?1:0,d=$(n).find("#idChapter").val(),c=$(e).attr("data-id-novel"),l={xuly:i,trangthai:s,id:d,id_novel:c,_token:$(r).find('input[name="_token"]').val()};$.ajax({method:"POST",url:o,data:JSON.stringify(l),contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){if(1==e.status)$(r).find(".alert-danger").fadeOut(200),$(r).find(".alert-success").fadeIn(200).html(e.message+t),$("body").trigger("ntp_author_load_novel_list"),$("#ntp_mucluc").html(e.table);else if(0==e.status){$(r).find(".alert-success").fadeOut(200);var n=e.errors,o="";for(var i in n)o+=n[i]+"</br>";$(r).find(".alert-danger").fadeIn(200).html(o+a)}$("body").trigger("ntp-alert-out")},error:function(){}})}),$("body").on("click",".ntp_alert_close .btn-close",function(){$(".alert-success").fadeOut(200),$(".alert-danger ").fadeOut(200)}),$("body").on("ntp-alert-out",function(){setTimeout(function(){$(".alert-success").fadeOut(200),$(".alert-danger ").fadeOut(200)},6e3)})});